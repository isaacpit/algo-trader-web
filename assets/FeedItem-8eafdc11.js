import{j as a,a as t}from"./index-3f0dce1e.js";import{r as d}from"./vendor-8a332d8f.js";import{C}from"./charts-07006e06.js";const _=({chartData:e,title:r,height:s=300,className:n="",onLoad:c,onError:i,renderStartTime:u,showLegend:h=!0,showTooltip:x=!0,showGrid:o=!0,showAxes:g=!0})=>{const v=d.useRef(null),m=d.useRef(null),p=d.useRef(!1),N=d.useRef(u||performance.now()),k=d.useCallback(()=>{c&&!p.current&&(p.current=!0,c())},[c]),b=d.useCallback(l=>{i&&!p.current&&(p.current=!0,i(l))},[i]),f=e&&e.labels&&e.datasets&&e.datasets.length>0&&e.datasets.every(l=>l.data&&l.data.length>0);return d.useEffect(()=>{var l;return console.log("[LAZY_CHART] Component mounted:",{title:r,hasChartData:!!e,hasValidChartData:f,chartDataKeys:e?Object.keys(e):null,datasetsCount:((l=e==null?void 0:e.datasets)==null?void 0:l.length)||0}),()=>{console.log("[LAZY_CHART] Component unmounted:",{title:r})}},[r,e,f]),d.useEffect(()=>{if(!f){console.log("[LAZY_CHART] No valid chart data available:",{title:r,chartData:e});return}const l=v.current;if(!l){console.error("[LAZY_CHART] Canvas ref not available");return}console.log("[LAZY_CHART] Creating chart:",{title:r,dataPoints:e.labels.length,datasets:e.datasets.length}),m.current&&(console.log("[LAZY_CHART] Destroying existing chart"),m.current.destroy());try{m.current=new C(l,{type:"line",data:e,options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!!r,text:r||"",color:"#6B7280",font:{size:14,weight:"bold"}},legend:{display:h,position:"top",labels:{usePointStyle:!0,padding:20,color:"#6B7280"}},tooltip:{enabled:x,mode:"index",intersect:!1,backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#6B7280",borderWidth:1}},scales:{x:{display:g,grid:{display:o,color:"rgba(107, 114, 128, 0.1)"},ticks:{color:"#6B7280",maxTicksLimit:8}},y:{display:g,grid:{display:o,color:"rgba(107, 114, 128, 0.1)"},ticks:{color:"#6B7280",callback:function(w){return"$"+w.toLocaleString()}}}},interaction:{intersect:!1,mode:"index"},elements:{point:{radius:0,hoverRadius:4},line:{tension:.4}}}});const y=performance.now()-N.current;console.log(`[LAZY_CHART] Chart created successfully in ${y.toFixed(2)}ms`),k&&k()}catch(y){console.error("[LAZY_CHART] Error creating chart:",y),b&&b(y)}},[e,r,h,x,o,g,k,b,f]),d.useEffect(()=>()=>{m.current&&(console.log("[LAZY_CHART] Cleaning up chart on unmount"),m.current.destroy())},[]),f?a("div",{className:`relative ${n}`,style:{height:`${s}px`},children:a("canvas",{ref:v})}):a("div",{className:`flex items-center justify-center bg-gray-50 dark:bg-gray-700 rounded-lg ${n}`,style:{height:`${s}px`},children:t("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[a("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),a("p",{className:"text-sm font-medium",children:"Chart data not available"}),r&&a("p",{className:"text-xs mt-1",children:r})]})})},A=({item:e,formatTimeAgo:r})=>{var c,i,u,h,x;console.log("[FEED_ITEM] Full item data received:",e),console.log("[FEED_ITEM] Item field analysis:",{id:e.id,type:e.type,hasChartData_camel:!!e.chartData,hasChartData_snake:!!e.chart_data,hasPerformance:!!e.performance,hasSignal:!!e.signal,hasBacktest:!!e.backtest,performanceFields:e.performance?Object.keys(e.performance):null,chartDataFields_camel:e.chartData?Object.keys(e.chartData):null,chartDataFields_snake:e.chart_data?Object.keys(e.chart_data):null,signalFields:e.signal?Object.keys(e.signal):null,backtestFields:e.backtest?Object.keys(e.backtest):null}),d.useEffect(()=>(console.log("[FEED_ITEM] FeedItem mounted:",{id:e.id,type:e.type}),()=>{console.log("[FEED_ITEM] FeedItem unmounted:",{id:e.id,type:e.type})}),[e.id,e.type]);const s=e.chart_data||e.chartData;console.log("[FEED_ITEM] Chart data for item",e.id,":",{labels:((c=s==null?void 0:s.labels)==null?void 0:c.length)||0,datasets:((i=s==null?void 0:s.datasets)==null?void 0:i.map(o=>{var g;return{label:o.label,dataLength:((g=o.data)==null?void 0:g.length)||0,hasBorderColor:!!o.borderColor,hasBackgroundColor:!!o.backgroundColor}}))||[]});const n={winRate:e.performance.win_rate||e.performance.winRate,profitFactor:e.performance.profit_factor||e.performance.profitFactor,totalTrades:e.performance.total_trades||e.performance.totalTrades,avgReturn:e.performance.avg_return||e.performance.avgReturn,maxDrawdown:e.performance.max_drawdown||e.performance.maxDrawdown,sharpeRatio:e.performance.sharpe_ratio||e.performance.sharpeRatio,sortino_ratio:e.performance.sortino_ratio,calmar_ratio:e.performance.calmar_ratio};return t("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[a("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-3",children:[a("img",{src:e.user.picture||`https://ui-avatars.com/api/?name=${encodeURIComponent(e.user.name)}&background=6366f1&color=fff`,alt:e.user.name,className:"w-10 h-10 rounded-full"}),t("div",{children:[t("div",{className:"flex items-center space-x-2",children:[a("span",{className:"font-medium text-gray-900 dark:text-white",children:e.user.name}),e.user.verified&&a("svg",{className:"w-4 h-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:a("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),t("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.user.followers.toLocaleString()," followers â€¢"," ",r(e.timestamp)]})]})]}),a("div",{className:"flex items-center space-x-2",children:a("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${e.type==="signal"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"}`,children:e.type==="signal"?"Signal":"Backtest"})})]})}),t("div",{className:"p-6",children:[e.type==="signal"&&e.signal?t("div",{children:[a("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:e.signal.name}),a("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:e.signal.description}),t("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t("div",{children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Entry"}),a("div",{className:"text-sm text-gray-900 dark:text-white",children:e.signal.entry})]}),t("div",{children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Target"}),a("div",{className:"text-sm text-green-600 dark:text-green-400",children:e.signal.target})]}),t("div",{children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Stop Loss"}),a("div",{className:"text-sm text-red-600 dark:text-red-400",children:e.signal.stop_loss||e.signal.stopLoss})]}),t("div",{children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Confidence"}),t("div",{className:"text-sm text-gray-900 dark:text-white",children:[e.signal.confidence,"%"]})]})]})]}):e.type==="backtest"&&e.backtest?t("div",{children:[a("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:e.backtest.name}),a("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:e.backtest.description}),t("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t("div",{children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Period"}),a("div",{className:"text-sm text-gray-900 dark:text-white",children:e.backtest.period})]}),t("div",{children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Initial Capital"}),t("div",{className:"text-sm text-gray-900 dark:text-white",children:["$",((u=e.backtest.initial_capital||e.backtest.initialCapital)==null?void 0:u.toLocaleString())||"N/A"]})]}),t("div",{children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Sharpe Ratio"}),a("div",{className:"text-sm text-gray-900 dark:text-white",children:((h=n.sharpeRatio)==null?void 0:h.toFixed(2))||"N/A"})]}),t("div",{children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Max Drawdown"}),t("div",{className:"text-sm text-red-600 dark:text-red-400",children:[((x=n.maxDrawdown)==null?void 0:x.toFixed(1))||"N/A","%"]})]})]})]}):t("div",{children:[a("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Unknown Item Type"}),a("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Unable to display item details"})]}),t("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[t("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Win Rate"}),t("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[n.winRate?(n.winRate*100).toFixed(1):"N/A","%"]})]}),t("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Profit Factor"}),a("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n.profitFactor?n.profitFactor.toFixed(2):"N/A"})]}),t("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total Trades"}),a("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:n.totalTrades||"N/A"})]})]}),a("div",{className:"h-64 mb-6",children:a(_,{chartData:s,title:e.type==="signal"&&e.signal?e.signal.name:e.type==="backtest"&&e.backtest?e.backtest.name:"Performance Chart",height:256})}),t("div",{className:"flex items-center justify-between",children:[t("div",{className:"flex items-center space-x-6",children:[t("button",{className:"flex items-center space-x-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:[a("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),a("span",{children:e.likes})]}),t("button",{className:"flex items-center space-x-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:[a("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),a("span",{children:e.comments})]}),t("button",{className:"flex items-center space-x-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:[a("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),a("span",{children:e.shares})]})]}),a("button",{className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700",children:e.type==="signal"?"Follow Signal":"View Details"})]})]})]})};export{A as default};
